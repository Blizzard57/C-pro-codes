#include<stdio.h>
int main()
{
    int l,t;
    scanf("%d",&t);

    for(l=0;l<t;l++)
    {
        if(l!=0)
            printf("\n");

        long long int max,max1,j;
        int v,c,n,k,i;
        scanf("%d",&n);
        scanf("%d",&k);

        long long int arr[n];
        long long int sum[n+1];
        sum[0]=0;

        for(i=0;i<n;i++)
        {
            scanf("%lld",&arr[i]);
            sum[i] = sum[i] + arr[i];
            sum[i+1]=sum[i];
        }

            max1 = arr[0];

        for(c=0;c<n;c++)
        {
            if(arr[c]>max1)
                max1 = arr[c];
        }

        max = sum[n-1];

        if(k==0)
            printf("%lld",sum[n-1]);
        else if(k==1)
        {
            for(v=0;v<n;v++)
            {
                if(sum[v]>max)
                    max=sum[v];
            }

            for(i=0;i<n-1;i++)
            {
                j = sum[n-1] - sum[i];
                if(j>max)
                    max=j;
            }
            printf("%lld",max);
        }
        else if(k>1) 
        {
            long long int max2=0,b=0;
            for(i=0;i<n;i++)
            {
                b = b + arr[i];
                if(b<0)
                    b=0;
                if(max2<b)
                    max2 = b;
            }
            if(max2==0)
                printf("%lld",max1);
            else
                printf("%lld",max2);
        }
    }
    return 0;
}
